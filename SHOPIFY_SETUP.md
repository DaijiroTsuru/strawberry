# Shopify統合セットアップガイド

このガイドでは、津留イチゴ園のウェブサイトにShopifyを統合する手順を説明します。

## 前提条件

- Shopifyアカウントとストアが作成済みであること
- Shopifyストアに商品が登録されていること

## ステップ1: Shopify Storefront APIアクセストークンの取得

1. Shopify管理画面にログイン
2. 「設定」→「アプリと販売チャネル」→「アプリとチャネルを開発する」
3. 「アプリを作成する」をクリック
4. アプリ名を入力（例：「津留イチゴ園ウェブサイト」）
5. 「Storefront API」のスコープを設定
   - 必要な権限：
     - `unauthenticated_read_product_listings`
     - `unauthenticated_read_product_inventory`
     - `unauthenticated_write_checkouts`
6. アクセストークンをコピー

## ステップ2: 環境変数の設定

`/src/utils/shopify.ts` ファイルを編集し、以下の値を設定してください：

```typescript
const SHOPIFY_DOMAIN = 'your-store-name.myshopify.com';
const STOREFRONT_ACCESS_TOKEN = 'your_storefront_access_token';
```

## ステップ3: 商品の登録

Shopify管理画面で以下の商品を登録してください。

### 商品登録用プロンプト

以下のプロンプトを使用して、Shopify管理画面で商品を効率的に登録できます：

#### 商品1: あまおう（特大サイズ）

```
商品名: あまおう（特大サイズ）
説明: 
福岡県産の最高級ブランドいちご「あまおう」。
大粒で甘みが強く、果肉がしっかりしているのが特徴です。
贈答用に最適な特大サイズのみを厳選してお届けします。

- 品種：あまおう
- 産地：福岡県
- サイズ：特大（1粒30g以上）
- 内容量：500g（約15-20粒）
- 賞味期限：冷蔵保存で3-4日
- 保存方法：要冷蔵（10℃以下）

価格: ¥3,800
バリアント: 500g
SKU: AMAOU-L-500
在庫管理: 有効
```

#### 商品2: とちおとめ（大サイズ）

```
商品名: とちおとめ（大サイズ）
説明:
栃木県を代表する品種「とちおとめ」。
程よい酸味と甘みのバランスが絶妙で、万人に愛される味わいです。
鮮やかな紅色と豊かな香りが特徴です。

- 品種：とちおとめ
- 産地：福岡県（契約農家栽培）
- サイズ：大（1粒20-25g）
- 内容量：400g（約20-25粒）
- 賞味期限：冷蔵保存で3-4日
- 保存方法：要冷蔵（10℃以下）

価格: ¥2,800
バリアント: 400g
SKU: TOCHI-L-400
在庫管理: 有効
```

#### 商品3: 紅ほっぺ（中サイズ）

```
商品名: 紅ほっぺ（中サイズ）
説明:
静岡県生まれの人気品種「紅ほっぺ」。
鮮やかな紅色と豊かな香り、しっかりとした甘みが特徴です。
デザートやスイーツ作りにも最適なサイズです。

- 品種：紅ほっぺ
- 産地：福岡県
- サイズ：中（1粒15-20g）
- 内容量：300g（約20-25粒）
- 賞味期限：冷蔵保存で3-4日
- 保存方法：要冷蔵（10℃以下）

価格: ¥2,200
バリアント: 300g
SKU: BENI-M-300
在庫管理: 有効
```

#### 商品4: いちごジャム（自家製）

```
商品名: いちごジャム（自家製）
説明:
完熟いちごをたっぷり使用した無添加の自家製ジャムです。
砂糖とレモン果汁のみで作られた、いちご本来の味わいをお楽しみいただけます。
パンやヨーグルトに最適です。

- 原材料：いちご（福岡県産）、砂糖、レモン果汁
- 内容量：200g
- 賞味期限：製造日から6ヶ月（開封後は冷蔵保存で2週間）
- 保存方法：直射日光を避け、常温保存（開封後は要冷蔵）
- 添加物：不使用

価格: ¥1,200
バリアント: 200g
SKU: JAM-200
在庫管理: 有効
```

## ステップ4: 商品画像の準備

各商品に高品質な画像をアップロードしてください：

- 推奨サイズ：1200x1200px以上
- ファイル形式：JPG または PNG
- 背景：白または自然光での撮影
- 最低3枚の画像（正面、斜め、クローズアップ）

## ステップ5: コレクションの作成

Shopify管理画面で以下のコレクションを作成してください：

1. **生いちご**
   - あまおう（特大サイズ）
   - とちおとめ（大サイズ）
   - 紅ほっぺ（中サイズ）

2. **加工品**
   - いちごジャム（自家製）

## ステップ6: 配送設定

1. Shopify管理画面の「設定」→「配送と配達」
2. 配送エリアを設定（日本全国）
3. 配送料金を設定：
   - クール便（冷蔵）必須
   - 北海道・沖縄：1,500円
   - その他の地域：1,000円
   - 10,000円以上のご購入で送料無料

## ステップ7: ウェブサイトへの統合

### 方法1: Shopify Buy Button SDKの使用（推奨）

```html
<script async src="https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js"></script>
```

### 方法2: Storefront APIの使用

`/src/utils/shopify.ts` の `fetchShopifyProducts()` 関数を使用して、商品データを取得します。

```typescript
import { fetchShopifyProducts } from '@/utils/shopify';

// コンポーネント内で使用
const products = await fetchShopifyProducts(10);
```

## ステップ8: カート機能の実装

### Shopify Buy Button SDKを使用する場合

```typescript
// カートに追加
ShopifyBuy.UI.onReady(client).then(function (ui) {
  ui.createComponent('product', {
    id: productId,
    node: document.getElementById('product-component'),
  });
});
```

### Storefront APIを使用する場合

カートの作成、更新、チェックアウトのためのGraphQL mutationを実装します。

## ステップ9: テスト

1. テスト注文を実行
2. 決済フローの確認
3. メール通知の確認
4. 在庫管理の確認

## セキュリティ上の注意

- Storefront APIアクセストークンは公開しても安全です（読み取り専用）
- Admin APIアクセストークンは絶対に公開しないでください
- 本番環境では環境変数を使用してトークンを管理してください

## サポート

質問や問題がある場合は、以下をご確認ください：

- [Shopify Storefront API ドキュメント](https://shopify.dev/api/storefront)
- [Shopify Buy Button SDK](https://shopify.github.io/buy-button-js/)
- [Shopify コミュニティフォーラム](https://community.shopify.com/)

## よくある質問

### Q: 在庫数はリアルタイムで反映されますか？
A: はい、Storefront APIを使用すると、リアルタイムで在庫状況が反映されます。

### Q: 複数のバリアント（サイズなど）を設定できますか？
A: はい、Shopifyの商品にバリアントを追加することで対応できます。

### Q: 定期購入は設定できますか？
A: Shopify Subscriptionsアプリを使用することで定期購入が可能です。

### Q: クーポンコードは使えますか？
A: はい、Shopify管理画面でディスカウントコードを作成できます。
